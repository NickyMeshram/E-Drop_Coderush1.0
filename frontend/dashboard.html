
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Telecom • CME Impact Dashboard</title>

<!-- Plotly -->
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<!-- Firebase JS SDK (compat version for browser) -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;500;700;800&display=swap" rel="stylesheet">

<style>
    
</style>
</head>
<body>
<div class="app">
    
</div>
<!-- JS: Simulation + Plotly + Canvas globe (ionosphere) + Hooks -->
<script>
    
</script>
</body>
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Telecom • CME Impact Dashboard</title>

<!-- Plotly -->
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;500;700;800&display=swap" rel="stylesheet">

<style>
    :root{ --bg-1: #f6faf7; --bg-2: #eaf7f3; --card: #ffffff; --muted: #5e6b63; --text: #0b2b24; --accent-cyan: #00bfb4; --accent-green: #67d9a3; --accent-olive: #4b8f6a; --warn: #ff8a1f; --danger: #ff4d4d; --glass: rgba(9,42,34,0.04); --radius: 14px; --shadow: 0 10px 30px rgba(18,40,34,0.06); } *{box-sizing:border-box} html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg-1),var(--bg-2));font-family:Inter,system-ui,Arial;color:var(--text);-webkit-font-smoothing:antialiased} .app { max-width:1300px;margin:18px auto;padding:18px; display:flex;flex-direction:column;gap:14px; } /* Header */ header{display:flex;align-items:center;gap:14px} .logo{width:60px;height:60px;border-radius:12px;background:linear-gradient(180deg,#dff7ee,#baf0da);display:flex;align-items:center;justify-content:center;font-weight:800;color:var(--accent-olive);box-shadow:var(--shadow)} .title{display:flex;flex-direction:column} .title h1{margin:0;font-size:20px;font-weight:800} .title p{margin:0;color:var(--muted);font-size:13px} /* Layout grid */ .grid {display:grid;grid-template-columns: 360px 1fr; gap:16px; align-items:start} @media (max-width:1000px){ .grid{grid-template-columns: 1fr} } /* Left column */ .left {display:flex;flex-direction:column;gap:12px} .panel {background:var(--card);border-radius:var(--radius);padding:12px;border:1px solid rgba(0,0,0,0.04);box-shadow:var(--shadow)} .panel .heading{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px} .panel .heading h3{margin:0;font-size:15px} .small-kv{display:flex;justify-content:space-between;padding:8px 6px;border-radius:8px;background:var(--bg-2);margin-bottom:6px} .kv-k{color:var(--muted);font-size:13px} .kv-v{font-weight:700;color:var(--accent-olive)} .panel .note{color:var(--muted);font-size:13px;margin-top:8px} #ionosphereCanvas{width:320px;height:320px;border-radius:12px;background:linear-gradient(180deg,#e6fbf6,#d8f6ee);display:block;border:1px solid rgba(0,0,0,0.03)} /* Right column */ .right {display:flex;flex-direction:column;gap:12px} .alert-banner{display:flex;align-items:center;gap:18px;padding:18px;border-radius:12px;background:linear-gradient(90deg,#ffffff,#effff8);border:1px solid rgba(0,0,0,0.04);box-shadow:var(--shadow)} .alert-left{display:flex;flex-direction:column;gap:6px} .alert-title{font-weight:800;font-size:20px} .alert-sub{color:var(--muted);font-size:13px} .alert-right{text-align:right} .alert-score{font-size:28px;font-weight:900;color:var(--accent-olive)} .alert-level{font-weight:800;font-size:16px;padding:6px 10px;border-radius:10px;color:#fff} .level-safe{background:linear-gradient(90deg,#2abf7a,#68d59c)} .level-watch{background:linear-gradient(90deg,#ffd28a,#ffb857);color:#3a2a00} .level-moderate{background:linear-gradient(90deg,#ffb089,#ff8a1f)} .level-severe{background:linear-gradient(90deg,#ff6b6b,#ff4d4d)} .charts-row{display:grid;grid-template-columns:repeat(3,1fr);gap:10px} @media (max-width:900px){ .charts-row{grid-template-columns:1fr} } .chart-card{padding:8px;border-radius:10px;background:var(--bg-2);min-height:150px;border:1px solid rgba(0,0,0,0.03)} .big-card{display:flex;gap:12px;padding:12px;border-radius:12px;background:var(--card);border:1px solid rgba(0,0,0,0.04);box-shadow:var(--shadow)} .metric{flex:1;padding:8px;border-radius:10px;background:linear-gradient(180deg,#ffffff,#f6fff6);text-align:center} .metric .m-k{color:var(--muted);font-size:13px} .metric .m-v{font-weight:800;color:var(--accent-cyan);font-size:18px} .recommendations{margin-top:18px;display:flex;flex-direction:column;gap:12px} .rec-card{background:linear-gradient(180deg,#fbfff9,#f3fbf5);padding:14px;border-radius:12px;border:1px solid rgba(0,0,0,0.03)} .rec-card h4{margin:0 0 8px 0} .rec-list{display:flex;flex-direction:column;gap:8px} .rec-item{display:flex;gap:12px;align-items:flex-start} .dot{width:10px;height:10px;border-radius:50%} .dot.info{background:var(--accent-cyan)} .dot.warn{background:var(--warn)} .dot.danger{background:var(--danger)} footer{margin-top:20px;text-align:center;color:var(--muted);font-size:13px;padding-bottom:20px}
</style>
</head>
<body>
<div class="app">
    <!-- header -->
    <header>
            <div class="logo">
                <img src="/static/e-drop-logo.png" alt="e-drop logo" style="width:60px;height:60px;border-radius:12px;">
            </div>
            <div class="title">
                <h1>CME Impact Dashboard</h1>
                <p>Tailored insights for telecom NOC engineers — real-time CME detection & operational recommendations</p>
            </div>
    </header>
    <div class="grid">
        <div class="left">
            <div class="panel">
                <div class="heading"><h3>Ionosphere Layer • Telecom Focus</h3><div style="color:var(--muted);font-size:12px">Altitude: ~250–500 km (TEC layer)</div></div>
                <canvas id="ionosphereCanvas"></canvas>
                <div class="note">Animated visualization shows disturbed regions (orange/red) where HF/GNSS effects likely. Particles illustrate propagation — for demo only.</div>
            </div>
            <div class="panel">
                <div class="heading"><h3>Quick Metrics</h3><div style="color:var(--muted);font-size:12px">Latest telemetry (simulated)</div></div>
                <div class="small-kv"><div class="kv-k">Solar Wind</div><div class="kv-v" id="kvSpeed">— km/s</div></div>
                <div class="small-kv"><div class="kv-k">IMF Bz</div><div class="kv-v" id="kvBz">— nT</div></div>
                <div class="small-kv"><div class="kv-k">Kp Index</div><div class="kv-v" id="kvKp">—</div></div>
                <div class="small-kv"><div class="kv-k">TEC (est.)</div><div class="kv-v" id="kvTec">— TECU</div></div>
                <div class="note">These are core inputs we use to compute a <strong>Telecom Risk Index</strong>.</div>
            </div>
            <div class="panel">
                <div class="heading"><h3>Critical Links</h3><div style="color:var(--muted);font-size:12px">Watchlist</div></div>
                <div style="display:flex;flex-direction:column;gap:8px">
                    <div style="display:flex;justify-content:space-between"><div style="color:var(--muted)">GEO Link • Sat-A (Indian)</div><div id="linkA" style="font-weight:800;color:#2c6f46">OK</div></div>
                    <div style="display:flex;justify-content:space-between"><div style="color:var(--muted)">GEO Link • Sat-B (Intl)</div><div id="linkB" style="font-weight:800;color:#2c6f46">OK</div></div>
                    <div style="display:flex;justify-content:space-between"><div style="color:var(--muted)">Backbone Latency (Trans-Asia)</div><div id="linkLatency" style="font-weight:800;color:var(--muted)">— ms</div></div>
                </div>
            </div>
        </div>
        <div class="right">
            <div class="alert-banner" role="status" aria-live="polite">
                <div class="alert-left">
                    <div class="alert-title">CURRENT CME STATUS</div>
                    <div class="alert-sub">Primary telecom concern: GNSS / HF degradation and GEO link margin reduction</div>
                    <div style="display:flex;gap:8px;margin-top:8px">
                        <div style="display:flex;flex-direction:column"><div style="color:var(--muted);font-size:13px">Alert Score</div><div class="alert-score" id="alertScore">0.00</div></div>
                        <div style="display:flex;flex-direction:column;margin-left:12px"><div style="color:var(--muted);font-size:13px">Predicted Next CME</div><div style="font-weight:800" id="predNext">—</div></div>
                    </div>
                </div>
                <div class="alert-right">
                    <div id="alertLevelBadge" class="alert-level level-safe">NOMINAL</div>
                    <div style="color:var(--muted);font-size:12px;margin-top:8px" id="nextEta">Next ETA: —</div>
                </div>
            </div>
            <div class="charts-row">
                <div class="chart-card panel">
                    <div style="font-weight:700;margin-bottom:6px">Solar Wind Speed</div>
                    <div id="chartVsw" style="height:150px"></div>
                </div>
                <div class="chart-card panel">
                    <div style="font-weight:700;margin-bottom:6px">IMF Bz (nT)</div>
                    <div id="chartBz" style="height:150px"></div>
                </div>
                <div class="chart-card panel">
                    <div style="font-weight:700;margin-bottom:6px">Kp Index</div>
                    <div id="chartKp" style="height:150px"></div>
                </div>
            </div>
            <div class="big-card">
                        <div style="flex:1">
                            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
                                <div style="font-weight:700">TEC Estimate & HF Blackout Index</div>
                                <div style="color:var(--muted);font-size:13px">Updated: <span id="lastUpdate">—</span></div>
                            </div>
                            <div id="chartTec" style="width:100%;height:260px"></div>
                            <!-- Video below the graph -->
                            <div style="margin-top:18px; text-align:center;">
                                <video controls style="max-width:100%; border-radius:12px; box-shadow:0 4px 24px rgba(0,0,0,0.12);">
                                    <source src="/static/WhatsApp Video 2025-08-23 at 5.34.58 AM.mp4" type="video/mp4">
                                    Your browser does not support the video tag.
                                </video>
                                <div style="color:var(--muted); font-size:15px; margin-top:8px;">UV Observation Video</div>
                            </div>
                        </div>
                <div style="width:260px;display:flex;flex-direction:column;gap:8px">
                    <div style="background:linear-gradient(180deg,#fff,#f7fff8);padding:10px;border-radius:10px;text-align:center">
                        <div style="color:var(--muted);font-size:13px">GNSS Error (est.)</div>
                        <div style="font-weight:800;font-size:20px;color:var(--accent-cyan)" id="gnssErr">0.0 m</div>
                    </div>
                    <div style="background:linear-gradient(180deg,#fff,#fff7f0);padding:10px;border-radius:10px;text-align:center">
                        <div style="color:var(--muted);font-size:13px">HF Blackout Index</div>
                        <div style="font-weight:800;font-size:20px;color:var(--warn)" id="hfIndex">0</div>
                    </div>
                    <div style="background:linear-gradient(180deg,#fff,#f7fff8);padding:10px;border-radius:10px;text-align:center">
                        <div style="color:var(--muted);font-size:13px">Link SNR (GEO)</div>
                        <div style="font-weight:800;font-size:20px;color:var(--accent-olive)" id="linkSnr">— dB</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="recommendations">
        <div class="rec-card">
            <h4>Operational Recommendations (Automated)</h4>
            <div class="rec-list" id="recList">
                <div class="rec-item"><div class="dot info"></div><div><strong>Nominal:</strong> All systems nominal. No immediate action required.</div></div>
                <div class="rec-item"><div class="dot warn"></div><div><strong>Watch:</strong> Consider rerouting critical GNSS-dependent traffic to terrestrial backups in next 2–4 hours.</div></div>
                <div class="rec-item"><div class="dot danger"></div><div><strong>Severe:</strong> If link margins fall below 3 dB, place GEO satellites into safe/low-power mode & activate backup LEO/GEO routing.</div></div>
            </div>
        </div>
        <div class="rec-card">
            <h4>Standard Operating Procedures (SOP)</h4>
            <ol style="color:var(--muted);line-height:1.6">
                <li>Confirm alert via two sensors (IMF Bz & sudden jump in solar wind speed) before initiating critical failover.</li>
                <li>Notify NOC leads via SMS & email; escalate to on-call RF engineer.</li>
                <li>Reduce antenna transmit power if SNR drops below safety threshold to protect hardware.</li>
                <li>Document event with timestamps & telemetry and upload to incident repo (CSV export available).</li>
            </ol>
        </div>
        <div class="rec-card">
            <h4>Downloadable Report</h4>
            <div style="display:flex;gap:10px;margin-top:8px">
                <button class="btn" onclick="downloadReport()">Download CSV</button>
                <button class="btn" onclick="downloadJSON()">Download JSON</button>
            </div>
        </div>
    </div>
    <footer>
        © 2025 Telecom CME Dashboard • Prototype — replace simulated feed with Aditya-L1 / enterprise telemetry.
    </footer>
    <div style="margin-top:32px; text-align:center;">
        <img src="/static/fits_grid.png" alt="All FITS Images (UV Observations)" style="max-width:100%; height:auto; border-radius:12px; box-shadow:0 4px 24px rgba(0,0,0,0.12);">
        <div style="color:var(--muted); font-size:15px; margin-top:8px;">All FITS Images (UV Observations)</div>
    </div>
</div>
<script>



// Firebase compat SDK for browser
const firebaseConfig = {
    apiKey: "AIzaSyB7XelRcT7BQtlOgT3VM4-ZrSOeXPEYkto",
    authDomain: "fir-realtimekotlin-470d2.firebaseapp.com",
    databaseURL: "https://fir-realtimekotlin-470d2-default-rtdb.firebaseio.com",
    projectId: "fir-realtimekotlin-470d2",
    storageBucket: "fir-realtimekotlin-470d2.firebasestorage.app",
    messagingSenderId: "184392363877",
    appId: "1:184392363877:web:a45be7b9f6e7962cab3b8c"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();



// --- Real-time graph update logic ---
const HISTORY_POINTS = 120;
const state = {
    t: [],
    vsw: [],
    bz: [],
    kp: [],
    tec: [],
    hf: []
};

function updatePlots() {
    Plotly.react('chartVsw', [{x: state.t, y: state.vsw, mode: 'lines', line: {color: '#00bfb4'}}], {margin: {t: 10, l: 40}});
    Plotly.react('chartBz', [{x: state.t, y: state.bz, mode: 'lines', line: {color: '#4b8f6a'}}], {margin: {t: 10, l: 40}});
    Plotly.react('chartKp', [{x: state.t, y: state.kp, mode: 'lines', line: {color: '#67d9a3'}}], {margin: {t: 10, l: 40}});
    Plotly.react('chartTec', [
        {x: state.t, y: state.tec, mode: 'lines', name: 'TEC (est)'},
        {x: state.t, y: state.hf, mode: 'lines', name: 'HF Index', yaxis: 'y2'}
    ], {
        margin: {t: 10, l: 40},
        yaxis: {title: 'TEC (TECU)'},
        yaxis2: {title: 'HF Index', overlaying: 'y', side: 'right', range: [0, 10]}
    });
}

function fetchTelemetry() {
    db.ref('/telemetry/latest').on('value', function(snapshot) {
        const data = snapshot.val();
        if (!data) return;
        // Add new data to arrays
        const now = new Date().toLocaleTimeString();
        state.t.push(now);
        state.vsw.push(data.solarWind || null);
        state.bz.push(data.imfBz || null);
        state.kp.push(data.kpIndex || null);
        state.tec.push(data.tecEstimate || null);
        state.hf.push(data.hfIndex || null);
        // Limit history
        Object.keys(state).forEach(k => { if (state[k].length > HISTORY_POINTS) state[k].shift(); });
        // Update metrics
        document.getElementById('kvSpeed').textContent = (data.solarWind || '—') + ' km/s';
        document.getElementById('kvBz').textContent = (data.imfBz || '—') + ' nT';
        document.getElementById('kvKp').textContent = (data.kpIndex || '—');
        document.getElementById('kvTec').textContent = (data.tecEstimate || '—') + ' TECU';
        document.getElementById('alertScore').textContent = (data.alertScore || 0).toFixed(2);
        // Update plots
        updatePlots();
    });
}

window.addEventListener('DOMContentLoaded', function() {
    // Initialize empty plots
    updatePlots();
    fetchTelemetry();
});

// ...existing JS code for simulation, charts, etc. (keep your previous JS code below this section)
</script>
</body>
</html>
